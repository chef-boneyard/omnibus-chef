#!/bin/bash
#
# Install a full Opscode Client
#

PROGNAME=`basename $0`
INSTALLER_DIR=/opt/chef

error_exit()
{
	echo "${PROGNAME}: ${1:-"Unknown Error"}" 1>&2
	exit 1
}

# rm -f before ln -sf is required for solaris 9
rm -f /usr/bin/chef-client
rm -f /usr/bin/chef-solo
rm -f /usr/bin/knife
rm -f /usr/bin/shef
rm -f /usr/bin/ohai

ln -sf $INSTALLER_DIR/bin/chef-client /usr/bin || error_exit "Cannot link chef-client to /usr/bin"
ln -sf $INSTALLER_DIR/bin/chef-solo /usr/bin || error_exit "Cannot link chef-solo to /usr/bin"
ln -sf $INSTALLER_DIR/bin/chef-apply /usr/bin || error_exit "Cannot link chef-apply to /usr/bin"
ln -sf $INSTALLER_DIR/bin/chef-shell /usr/bin || error_exit "Cannot link chef-shell to /usr/bin"
ln -sf $INSTALLER_DIR/bin/knife /usr/bin || error_exit "Cannot link knife to /usr/bin"
ln -sf $INSTALLER_DIR/bin/shef /usr/bin || error_exit "Cannot link shef to /usr/bin"
ln -sf $INSTALLER_DIR/bin/ohai /usr/bin || error_exit "Cannot link ohai to /usr/bin"

echo "Thank you for installing Chef!"
echo "You can configure this client again using /opt/chef/setup.sh"

exit 0
